parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"da5Z":[function(require,module,exports) {
"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.principalAxesToOrientation=void 0;var t=function(t,r,i){void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0);var n="object"===o(t)?t:{yaw:t,pitch:r,roll:i},e=n.yaw,a=void 0===e?0:e,y=n.pitch,p=void 0===y?0:y,c=n.roll,s=void 0===c?0:c,l={x:0,y:0,z:0},u={x:0,y:0,z:0},f=a*(Math.PI/180);l.x=Math.sin(f),l.z=Math.cos(f+Math.PI);var h=p*(Math.PI/180);l.y=Math.sin(h),u.y=Math.cos(h);var v=s*(Math.PI/180);return u.x=Math.sin(v),u.z=Math.sin(v),{forward:l,up:u}};exports.principalAxesToOrientation=t;
},{}],"hDlH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){this.currentTime=Date.now()}return e.prototype.getDelta=function(){var e=Date.now(),t=(e-this.currentTime)/1e3;return this.currentTime=e,t},e}();exports.default=e;
},{}],"FRpO":[function(require,module,exports) {
"use strict";var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function r(e){console&&console.warn&&console.warn(e)}e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}module.exports=o,module.exports.once=m,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var o,s,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),c=s[t]),void 0===c)c=s[t]=n,++e._eventsCount;else if("function"==typeof c?c=s[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(o=f(e))>0&&c.length>o&&!c.warned){c.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=e,v.type=t,v.count=c.length,r(v)}return e}function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=v.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?d(i):h(i,i.length)}function a(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function d(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function m(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&L(e,i,{once:!0})})}function L(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)})}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var c=f.length,v=h(f,c);for(r=0;r<c;++r)n(v[r],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return u(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():y(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):a.call(e,t)},o.prototype.listenerCount=a,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};
},{}],"oFSR":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,i,e,n){return new(e||(e=Promise))(function(o,s){function r(t){try{a(n.next(t))}catch(i){s(i)}}function c(t){try{a(n.throw(t))}catch(i){s(i)}}function a(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e(function(t){t(i)})).then(r,c)}a((n=n.apply(t,i||[])).next())})},i=this&&this.__generator||function(t,i){var e,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;r;)try{if(e=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=i.call(t,r)}catch(c){s=[6,c],n=0}finally{e=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},e=this&&this.__spreadArray||function(t,i,e){if(e||2===arguments.length)for(var n,o=0,s=i.length;o<s;o++)!n&&o in i||(n||(n=Array.prototype.slice.call(i,0,o)),n[o]=i[o]);return t.concat(n||Array.prototype.slice.call(i))};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("events"),o=function(){function o(t){this.eventEmitter=new n.EventEmitter,this.loadingFilters={},this.activeFilters={},this.filterChain=[],this.sounityController=t,this.audioCtx=t.getAudioCtx()}return o.prototype.on=function(t,i){this.eventEmitter.on(t,i)},o.prototype.emit=function(t){for(var i,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return(i=this.eventEmitter).emit.apply(i,e([t],n,!1))},o.prototype.once=function(t,i){this.eventEmitter.once(t,i)},o.prototype.setOutputNode=function(t){this.destination&&(this.outputNode&&this.outputNode.disconnect(this.destination),t.connect(this.destination)),this.outputNode=t},o.prototype.connect=function(t){this.destination&&(this.hasActiveFilters()?this.outputFilterNode&&this.outputFilterNode.disconnect(this.destination):this.outputNode&&this.outputNode.disconnect(this.destination)),this.hasActiveFilters()?this.outputFilterNode&&this.outputFilterNode.connect(t):this.outputNode&&this.outputNode.connect(t),this.destination=t},o.prototype.disconnect=function(){this.hasActiveFilters()?this.outputFilterNode&&this.outputFilterNode.disconnect():this.outputNode&&this.outputNode.disconnect(),this.destination=null},o.prototype.addFilter=function(e){return t(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:if(e in this.activeFilters)throw new Error("There is already a active filter with given identifier '"+e+"'");return[4,this.loadingFilters[e]=this.addFilterAsync(e)];case 1:return t.sent(),delete this.loadingFilters[e],[2]}})})},o.prototype.addFilterAsync=function(e){return t(this,void 0,void 0,function(){var t,n,o,s,r;return i(this,function(i){switch(i.label){case 0:return"biquad"!==(t=this.sounityController.getFilterOptions(e)).type?[3,1]:(o=t.options,n=new BiquadFilterNode(this.audioCtx,o),[3,5]);case 1:return"convolver"!==t.type?[3,5]:(o=t.options,[4,fetch(o.url)]);case 2:return[4,i.sent().arrayBuffer()];case 3:return s=i.sent(),[4,this.audioCtx.decodeAudioData(s)];case 4:r=i.sent(),n=new ConvolverNode(this.audioCtx,{buffer:r,disableNormalization:o.disableNormalization}),i.label=5;case 5:if(!n)throw new Error("Invalid filter type '"+t.type+"'");return this.activeFilters[e]=n,this.connectFilter(e),[2]}})})},o.prototype.connectFilter=function(t){var i=this.activeFilters[t];if(this.filterChain.length){var e=this.activeFilters[this.filterChain[this.filterChain.length-1]];this.destination?(e.disconnect(this.destination),e.connect(i),i.connect(this.destination),this.outputFilterNode=i):(e.connect(i),this.outputFilterNode=i)}else this.destination&&this.outputNode.disconnect(this.destination),this.outputNode.connect(i),this.outputFilterNode=i,this.destination&&i.connect(this.destination);this.filterChain.push(t)},o.prototype.hasActiveFilters=function(){return this.filterChain.length>0},o.prototype.removeFilter=function(e){return t(this,void 0,void 0,function(){var t,n,o,s,r,c;return i(this,function(i){switch(i.label){case 0:return this.loadingFilters[e]?[4,this.loadingFilters[e]]:[3,2];case 1:i.sent(),i.label=2;case 2:if(void 0===(t=this.activeFilters[e]))throw new Error("Invalid filtername '"+e+"'.");return n=this.filterChain.indexOf(e),o=n===this.filterChain.length-1,(s=0===n)||o?s&&!o?(r=this.activeFilters[this.filterChain[n+1]],this.outputNode&&this.outputNode.disconnect(t),this.outputNode&&this.outputNode.connect(r),t.disconnect(r)):!s&&o?((c=this.activeFilters[this.filterChain[n-1]]).disconnect(t),this.destination&&t.disconnect(this.destination),this.destination&&c.connect(this.destination)):s&&o&&(t.disconnect(this.destination),this.outputNode.disconnect(t),this.destination&&this.outputNode.connect(this.destination)):(c=this.activeFilters[this.filterChain[n-1]],r=this.activeFilters[this.filterChain[n+1]],c.disconnect(t),t.disconnect(r),c.connect(r)),this.filterChain.splice(n,1),delete this.activeFilters[e],[2]}})})},o}();exports.default=o;
},{"events":"FRpO"}],"mwii":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var o=e(require("./SounityBaseNode")),r=function(e){function o(t){var o=e.call(this,t)||this;return o.masterVolumeGainNode=o.audioCtx.createGain(),o.setOutputNode(o.masterVolumeGainNode),o}return t(o,e),o.prototype.getInputNode=function(){return this.masterVolumeGainNode},o.prototype.tick=function(t){},o}(o.default);exports.default=r;
},{"./SounityBaseNode":"oFSR"}],"WCVk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Get=void 0;var e={};function t(t,n,r){return void 0!==n?n:t in e?e[t]:r}fetch("https://"+GetParentResourceName()+"/sounity:get-defaults").then(function(e){return e.text()}).then(function(e){return JSON.parse(JSON.parse(e))}).then(function(t){return Object.keys(t).forEach(function(n){return e[n]=t[n]})}),exports.Get=t;
},{}],"jVhG":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,a){function c(t){try{u(r.next(t))}catch(n){a(n)}}function o(t){try{u(r.throw(t))}catch(n){a(n)}}function u(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e(function(t){t(n)})).then(c,o)}u((r=r.apply(t,n||[])).next())})},n=this&&this.__generator||function(t,n){var e,r,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=n.call(t,c)}catch(o){a=[6,o],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){this.cache={}}return e.getInstance=function(){return null===this.instance&&(this.instance=new e),this.instance},e.prototype.loadUrl=function(e){var r=this;return new Promise(function(i,a){return t(r,void 0,void 0,function(){var r,c=this;return n(this,function(o){switch(o.label){case 0:return e in this.cache?(r=i,[4,this.cache[e].arrayBuffer()]):[3,2];case 1:return[2,r.apply(void 0,[o.sent()])];case 2:return fetch(e).then(function(r){return t(c,void 0,void 0,function(){var t;return n(this,function(n){switch(n.label){case 0:return[4,r.blob()];case 1:return t=n.sent(),this.cache[e]=t,[4,t.arrayBuffer()];case 2:return[2,n.sent()]}})})}).then(function(t){i(t)}).catch(a),[2]}})})})},e.instance=null,e}();exports.default=e;
},{}],"Kc5U":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),e=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&e(n,t,i);return o(n,t),n},i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{u(n.next(t))}catch(e){r(e)}}function a(t){try{u(n.throw(t))}catch(e){r(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(s,a)}u((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(a){r=[6,a],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ESounitySourceNodeState=void 0;var a,u=require("../helper/CalcOrientation"),p=n(require("../helper/DefaultOptions")),l=s(require("./SounityBaseNode")),c=s(require("../helper/SoundLoader"));!function(t){t[t.SETUP=0]="SETUP",t[t.READY=1]="READY",t[t.PLAYING=2]="PLAYING",t[t.FINISHED=3]="FINISHED",t[t.ERROR=4]="ERROR"}(a=exports.ESounitySourceNodeState||(exports.ESounitySourceNodeState={}));var h=function(e){function o(t,o,n,i){var r=e.call(this,i)||this;return r.state=a.SETUP,r.identifier=t,r.url=o,r.sounityController=i,r.audioCtx=i.getAudioCtx(),r.options=n,r.loop=p.Get("loop",n.loop,!1),r.outputType=p.Get("outputType",n.outputType,"sfx"),r.volume=p.Get("volume",n.volume,1),r.move(p.Get("posX",n.posX,0),p.Get("posY",n.posY,0),p.Get("posZ",n.posZ,0)),r.rotate(p.Get("rotX",n.rotX,0),p.Get("rotY",n.rotY,0),p.Get("rotZ",n.rotZ,0)),r.setup(),r}return t(o,e),o.prototype.setup=function(){return i(this,void 0,void 0,function(){var t,e,o,n,i;return r(this,function(r){switch(r.label){case 0:return t=[],e=this,n=(o=this.audioCtx).decodeAudioData,[4,c.default.getInstance().loadUrl(this.url)];case 1:return[4,n.apply(o,[r.sent()])];case 2:e.audioBuffer=r.sent(),this.audioBufferSourceNode=this.audioCtx.createBufferSource(),this.audioBufferSourceNode.loop=p.Get("loop",this.options.loop,!1),this.audioBufferSourceNode.buffer=this.audioBuffer,this.duration=this.audioBuffer.duration,this.volumeGainNode=this.audioCtx.createGain(),this.volumeGainNode.gain.value=this.getVolume(),this.pannerNode=this.audioCtx.createPanner(),this.pannerNode.panningModel=p.Get("panningModel",this.options.panningModel,"HRTF"),this.pannerNode.distanceModel=p.Get("distanceModel",this.options.distanceModel,"inverse"),this.pannerNode.maxDistance=p.Get("maxDistance",this.options.maxDistance,500),this.pannerNode.refDistance=p.Get("refDistance",this.options.refDistance,3),this.pannerNode.rolloffFactor=p.Get("rolloffFactor",this.options.refDistance,1),this.pannerNode.coneInnerAngle=p.Get("coneInnerAngle",this.options.coneInnerAngle,360),this.pannerNode.coneOuterAngle=p.Get("coneOuterAngle",this.options.coneOuterAngle,0),this.pannerNode.coneOuterGain=p.Get("coneOuterGain",this.options.coneOuterGain,0),this.pannerNode.positionX.value=this.posX,this.pannerNode.positionY.value=this.posY,this.pannerNode.positionZ.value=this.posZ,this.pannerNode.orientationX.value=this.rotX,this.pannerNode.orientationY.value=this.rotY,this.pannerNode.orientationZ.value=this.rotZ,this.audioBufferSourceNode.connect(this.volumeGainNode),this.volumeGainNode.connect(this.pannerNode),this.setOutputNode(this.pannerNode),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,Promise.all(t)];case 4:return r.sent(),this.setState(a.READY),[3,6];case 5:return i=r.sent(),console.error(i),this.setState(a.ERROR),[3,6];case 6:return[2]}})})},o.prototype.setState=function(t){this.state=t,t===a.READY&&this.emit("ready"),this.emit("statechange")},o.prototype.getState=function(){return this.state},o.prototype.start=function(t){var e=this;if(this.state!==a.ERROR){if(this.state===a.SETUP)return this.once("ready",function(){return e.start(t)});var o=0;if(void 0!==t&&this.duration!==1/0){var n=t/1e3;if(n>=this.duration&&!0===this.loop)o=n%this.duration;else{if(!(n<this.duration))return;o=n}}this.audioBufferSourceNode.start(0,o)}},o.prototype.move=function(t,e,o){this.posX=t,this.posY=o,this.posZ=e},o.prototype.rotate=function(t,e,o){var n=(0,u.principalAxesToOrientation)(-1*o,t,e).forward;this.rotX=n.x,this.rotY=n.y,this.rotZ=n.z},o.prototype.stop=function(){var t=this;if(this.state!==a.ERROR)return this.state===a.SETUP?this.once("ready",function(){return t.stop()}):void this.audioBufferSourceNode.stop(0)},o.prototype.dispose=function(){this.disconnect()},o.prototype.getVolume=function(){return"music"===this.outputType?this.volume*this.sounityController.getMusicVolume():"sfx"===this.outputType?this.volume*this.sounityController.getSfxVolume():this.volume},o.prototype.tick=function(t){this.pannerNode.positionX.linearRampToValueAtTime(this.posX,t),this.pannerNode.positionY.linearRampToValueAtTime(this.posY,t),this.pannerNode.positionZ.linearRampToValueAtTime(this.posZ,t),this.pannerNode.orientationX.linearRampToValueAtTime(this.rotX,t),this.pannerNode.orientationY.linearRampToValueAtTime(this.rotY,t),this.pannerNode.orientationZ.linearRampToValueAtTime(this.rotZ,t),this.volumeGainNode.gain.linearRampToValueAtTime(this.getVolume(),t)},o}(l.default);exports.default=h;
},{"../helper/CalcOrientation":"da5Z","../helper/DefaultOptions":"WCVk","./SounityBaseNode":"oFSR","../helper/SoundLoader":"jVhG"}],"bqIE":[function(require,module,exports) {
"use strict";var t=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]}),e=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(null!=i)for(var r in i)"default"!==r&&Object.prototype.hasOwnProperty.call(i,r)&&t(o,i,r);return e(o,i),o},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./helper/CalcOrientation"),n=o(require("./helper/Clock")),s=o(require("./nodes/SounityOutputNode")),u=i(require("./nodes/SounitySoundNode")),a=function(){function t(){var t=this;this.soundNodes={},this.availableFilters={},this.clock=new n.default,this.posX=0,this.posY=0,this.posZ=0,this.forwardX=1,this.forwardY=0,this.forwardZ=0,this.upX=0,this.upY=1,this.upZ=0,this.masterVolume=1,this.sfxVolume=1,this.musicVolume=1,this.audioCtx=new AudioContext,this.outputNode=new s.default(this),this.outputNode.connect(this.audioCtx.destination),this.tickId=setInterval(function(){t.tick()})}return t.prototype.moveListener=function(t,e,i){this.posX=t,this.posY=i,this.posZ=e},t.prototype.rotateListener=function(t,e,i){var o=(0,r.principalAxesToOrientation)(i,t,e),n=o.forward,s=o.up;this.forwardX=n.x,this.forwardY=-1*n.y,this.forwardZ=n.z,this.upX=s.x,this.upY=s.y,this.upZ=s.z},t.prototype.setVolume=function(t,e){this.sfxVolume=t,this.musicVolume=e},t.prototype.getAudioCtx=function(){return this.audioCtx},t.prototype.getSoundNode=function(t){if(t in this.soundNodes)return this.soundNodes[t];throw new Error("There does not exists a sound with given identifier '"+t+"'")},t.prototype.createSound=function(t,e,i){if(t in this.soundNodes)throw new Error("There already exists a sound with given identifier '"+t+"'");var o=new u.default(t,e,i,this);o.connect(this.outputNode.getInputNode()),this.soundNodes[t]=o},t.prototype.startSound=function(t,e){this.getSoundNode(t).start(e)},t.prototype.stopSound=function(t){this.getSoundNode(t).stop()},t.prototype.setCurrentTime=function(t,e){},t.prototype.moveSound=function(t,e,i,o){this.getSoundNode(t).move(e,i,o)},t.prototype.rotateSound=function(t,e,i,o){this.getSoundNode(t).rotate(e,i,o)},t.prototype.disposeSound=function(t){this.getSoundNode(t).dispose()},t.prototype.tick=function(){var t=this.audioCtx.currentTime+this.clock.getDelta();this.audioCtx.listener.positionX.linearRampToValueAtTime(this.posX,t),this.audioCtx.listener.positionY.linearRampToValueAtTime(this.posY,t),this.audioCtx.listener.positionZ.linearRampToValueAtTime(this.posZ,t),this.audioCtx.listener.forwardX.linearRampToValueAtTime(this.forwardX,t),this.audioCtx.listener.forwardY.linearRampToValueAtTime(this.forwardY,t),this.audioCtx.listener.forwardZ.linearRampToValueAtTime(this.forwardZ,t),this.audioCtx.listener.upX.linearRampToValueAtTime(this.upX,t),this.audioCtx.listener.upY.linearRampToValueAtTime(this.upY,t),this.audioCtx.listener.upZ.linearRampToValueAtTime(this.upZ,t);for(var e=0,i=Object.values(this.soundNodes);e<i.length;e++){var o=i[e];o.getState()!==u.ESounitySourceNodeState.SETUP&&o.tick(t)}this.outputNode.tick(t)},t.prototype.createFilter=function(t,e,i){if(t in this.availableFilters)throw new Error("There already exists a filter with given identifier '"+t+"'");this.availableFilters[t]={type:e,options:i}},t.prototype.getFilterOptions=function(t){if(t in this.availableFilters)return this.availableFilters[t];throw new Error("There does not exists a filter with given identifier '"+t+"'")},t.prototype.addSoundFilter=function(t,e){this.getSoundNode(t).addFilter(e)},t.prototype.removeSoundFilter=function(t,e){this.getSoundNode(t).removeFilter(e)},t.prototype.addListenerFilter=function(t){this.outputNode.addFilter(t)},t.prototype.removeListenerFilter=function(t){this.outputNode.removeFilter(t)},t.prototype.getMusicVolume=function(){return this.musicVolume/10},t.prototype.getSfxVolume=function(){return this.sfxVolume/10},t}();exports.default=a;
},{"./helper/CalcOrientation":"da5Z","./helper/Clock":"hDlH","./nodes/SounityOutputNode":"mwii","./nodes/SounitySoundNode":"Kc5U"}],"ZCfc":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("./SounityController")),i=new t.default;window.sounityController=i;var o={update:function(e){i.moveListener(e.posX,e.posY,e.posZ),i.rotateListener(e.rotX,e.rotY,e.rotZ),i.setVolume(e.sfxVolume,e.musicVolume)},moveSound:function(e){i.moveSound(e.identifier,e.posX,e.posY,e.posZ)},rotateSound:function(e){i.rotateSound(e.identifier,e.rotX,e.rotY,e.rotZ)},createSound:function(e){i.createSound(e.identifier,e.source,e.options)},startSound:function(e){i.startSound(e.identifier,e.startTime)},stopSound:function(e){i.stopSound(e.identifier)},disposeSound:function(e){i.disposeSound(e.identifier)},addSoundFilter:function(e){i.addSoundFilter(e.identifier,e.filterName)},removeSoundFilter:function(e){i.removeSoundFilter(e.identifier,e.filterName)},addListenerFilter:function(e){i.addListenerFilter(e.filterName)},removeListenerFilter:function(e){i.removeListenerFilter(e.filterName)},createFilter:function(e){i.createFilter(e.filterName,e.filterType,e.options)}};window.addEventListener("message",function(e){e.data.type in o&&o[e.data.type](e.data)}),fetch("https://"+GetParentResourceName()+"/sounity:ready");
},{"./SounityController":"bqIE"}]},{},["ZCfc"], null)
//# sourceMappingURL=/main.js.map